<!DOCTYPE html>
<html>
<head>
    <title>CATS-Portfolio Item Health Summary-0.0.1</title>
    <!--  (c) 2017 CA Technologies.  All Rights Reserved. -->
    <!--  Build Date: Wed Feb 21 2018 06:17:57 GMT+0000 (UTC) -->

    <script type="text/javascript">
        var APP_BUILD_DATE = "Wed Feb 21 2018 06:17:57 GMT+0000 (UTC)";
        var ARTIFACT = "";
        var BUILDER  = "ec2-user";
        var CHECKSUM = 18768247813;
    </script>

    <script type="text/javascript" src="/apps/2.1/sdk.js"></script>
    <!-- our highcharts (needed so that we can add patterns)
    <script type="text/javascript" src="/apps/2.1/lib/analytics/analytics-all.js"></script>
    -->


    <script type="text/javascript">
        Rally.onReady(function() {
            String.prototype.startsWith||(String.prototype.startsWith=function(a,b){return this.substr(!b||0>b?0:+b,a.length)===a}),Ext.define("Rally.technicalservices.InfoLink",{extend:"Rally.ui.dialog.Dialog",alias:"widget.tsinfolink",informationHtml:null,title:"Build Information",defaults:{padding:5,margin:5},closable:!0,draggable:!0,autoShow:!0,width:350,informationalConfig:null,showLog:!1,logger:null,items:[{xtype:"container",itemId:"information"},{xtype:"container",itemId:"button_box"}],initComponent:function(){Ext.id(this);this.title="<span class='icon-help'> </span>"+this.title,this.callParent(arguments)},_generateChecksum:function(a){var b,c=305419896;for(a=a.replace(/var CHECKSUM = .*;/,""),a=a.replace(/var BUILDER  = .*;/,""),a=a.replace(/\s/g,""),b=0;b<a.length;b++)c+=a.charCodeAt(b)*b;return c},_checkChecksum:function(a){var b=Ext.create("Deft.Deferred"),c=this;return Ext.Ajax.request({url:document.URL,params:{id:1},success:function(a){if(text=a.responseText,CHECKSUM){var d=c._generateChecksum(text);if(CHECKSUM!==d)return void b.resolve(!1)}b.resolve(!0)}}),b.promise},_addToContainer:function(a){var b=Ext.apply({xtype:"container",height:200,overflowY:!0},this.informationalConfig);a.add(b)},afterRender:function(){var a=Rally.getApp();if(!Ext.isEmpty(this.informationalConfig)){var b=this.down("#information");this._addToContainer(b)}this.showLog&&this.logger&&this.down("#button_box").add({xtype:"rallybutton",text:"Show Log",listeners:{scope:this,click:function(){this.logger.displayLog()}}}),a.isExternal()?this.addDocked({xtype:"container",cls:"build-info",padding:2,dock:"bottom",html:"... Running externally"}):this._checkChecksum(a).then({scope:this,success:function(a){a||this.addDocked({xtype:"container",cls:"build-info",dock:"bottom",padding:2,html:'<span class="icon-warning"> </span>Checksums do not match'})},failure:function(a){console.log("oops:",a)}}),this.callParent(arguments)},beforeRender:function(){if(this.callParent(arguments),this.informationHtml&&this.addDocked({xtype:"component",componentCls:"intro-panel",padding:2,html:this.informationHtml,dock:"bottom"}),this.addDocked({xtype:"container",cls:"build-info",padding:2,dock:"bottom",html:"This app was created by the CA AC Technical Services Team."}),APP_BUILD_DATE){var a=Ext.String.format("Built on: {0} <br/>Built by: {1}",APP_BUILD_DATE,BUILDER);ARTIFACT&&(a=a+"<br/>Source artifact: "+ARTIFACT),this.addDocked({xtype:"container",cls:"build-info",padding:2,dock:"top",html:a})}}}),Ext.define("CArABU.technicalservices.Logger",{saveForLater:!1,saveLines:100,logArray:[],constructor:function(a){Ext.apply(this,a)},setSaveForLater:function(a){this.saveForLater=a},log:function(a){var b="[ "+Ext.util.Format.date(new Date,"Y-m-d H:i:s.u")+" ]",c=[];c=Ext.Array.push(c,[b]),c=Ext.Array.push(c,Ext.Array.slice(arguments,0)),this.saveForLater&&(this.logArray||(this.logArray=[]),this.logArray.push(c.join(" ")),this.logArray.length>this.saveLines&&this.logArray.shift()),window.console&&console.log.apply(console,c)},getLogText:function(){return this.logArray&&0!==this.logArray.length?this.logArray.join("<br/>"):"-- no log --"},displayLog:function(){var a=this.getLogText();this.popup=Ext.create("Rally.ui.dialog.Dialog",{width:Ext.getBody().getWidth()-20,height:Ext.getBody().getHeight()-20,closable:!0,title:"Log",autoShow:!0,layout:"border",defaults:{layout:"fit",width:"50%",border:!1},items:[{region:"center",xtype:"container",html:a,autoScroll:!0}]})}}),Ext.define("TSUtilities",{singleton:!0,loadWsapiRecords:function(a){var b=Ext.create("Deft.Deferred"),c={model:"Defect",fetch:["ObjectID"]};return Ext.create("Rally.data.wsapi.Store",Ext.Object.merge(c,a)).load({callback:function(a,c,d){d?b.resolve(a):(console.error("Failed: ",c),b.reject("Problem loading: "+c.error.errors.join(". ")))}}),b.promise},loadAStoreWithAPromise:function(a,b){var c=Ext.create("Deft.Deferred");return Ext.create("Rally.data.wsapi.Store",{model:a,fetch:b}).load({callback:function(a,b,d){d?c.resolve(this):(console.error("Failed: ",b),c.reject("Problem loading: "+b.error.errors.join(". ")))}}),c.promise}}),Ext.define("TsSvgIcons",{statics:{better:'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 47.5 47.5" style="enable-background:new 0 0 47.5 47.5;" xml:space="preserve" version="1.1" id="svg2"><metadata id="metadata8"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/></cc:Work></rdf:RDF></metadata><defs id="defs6"><clipPath id="clipPath16" clipPathUnits="userSpaceOnUse"><path id="path18" d="M 0,38 38,38 38,0 0,0 0,38 Z"/></clipPath></defs><g transform="matrix(1.25,0,0,-1.25,0,47.5)" id="g10"><g id="g12"><g clip-path="url(#clipPath16)" id="g14"><g transform="translate(36,19)" id="g20"><path id="path22" style="fill:#ffcc4d;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 c 0,-9.389 -7.611,-17 -17,-17 -9.388,0 -17,7.611 -17,17 0,9.388 7.612,17 17,17 C -7.611,17 0,9.388 0,0"/></g><g transform="translate(11,24)" id="g24"><path id="path26" style="fill:#664500;fill-opacity:1;fill-rule:nonzero;stroke:none" d="M 0,0 C 0,0 0,2 2,2 4,2 4,0 4,0 l 0,-2 c 0,0 0,-2 -2,-2 -2,0 -2,2 -2,2 l 0,2 z"/></g><g transform="translate(23,24)" id="g28"><path id="path30" style="fill:#664500;fill-opacity:1;fill-rule:nonzero;stroke:none" d="M 0,0 C 0,0 0,2 2,2 4,2 4,0 4,0 l 0,-2 c 0,0 0,-2 -2,-2 -2,0 -2,2 -2,2 l 0,2 z"/></g><g transform="translate(28.335,14.3711)" id="g32"><path id="path34" style="fill:#664500;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 c -0.178,0.161 -0.444,0.171 -0.635,0.029 -0.039,-0.029 -3.922,-2.9 -8.7,-2.9 -4.766,0 -8.662,2.871 -8.7,2.9 -0.191,0.142 -0.457,0.13 -0.635,-0.029 -0.177,-0.16 -0.217,-0.424 -0.094,-0.628 0.129,-0.215 3.217,-5.243 9.429,-5.243 6.212,0 9.301,5.028 9.429,5.243 C 0.217,-0.423 0.178,-0.16 0,0"/></g></g></g></g></svg>',worse:'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 47.5 47.5" style="enable-background:new 0 0 47.5 47.5;" xml:space="preserve" version="1.1" id="svg2"><metadata id="metadata8"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/></cc:Work></rdf:RDF></metadata><defs id="defs6"><clipPath id="clipPath16" clipPathUnits="userSpaceOnUse"><path id="path18" d="M 0,38 38,38 38,0 0,0 0,38 Z"/></clipPath></defs><g transform="matrix(1.25,0,0,-1.25,0,47.5)" id="g10"><g id="g12"><g clip-path="url(#clipPath16)" id="g14"><g transform="translate(36,19)" id="g20"><path id="path22" style="fill:#ffcc4d;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 c 0,-9.389 -7.611,-17 -17,-17 -9.388,0 -17,7.611 -17,17 0,9.388 7.612,17 17,17 C -7.611,17 0,9.388 0,0"/></g><g transform="translate(11,24)" id="g24"><path id="path26" style="fill:#664500;fill-opacity:1;fill-rule:nonzero;stroke:none" d="M 0,0 C 0,0 0,2 2,2 4,2 4,0 4,0 l 0,-2 c 0,0 0,-2 -2,-2 -2,0 -2,2 -2,2 l 0,2 z"/></g><g transform="translate(23,24)" id="g28"><path id="path30" style="fill:#664500;fill-opacity:1;fill-rule:nonzero;stroke:none" d="M 0,0 C 0,0 0,2 2,2 4,2 4,0 4,0 l 0,-2 c 0,0 0,-2 -2,-2 -2,0 -2,2 -2,2 l 0,2 z"/></g><g transform="translate(9.6652,8.6286)" id="g32"><path id="path34" style="fill:#664500;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 c 0.178,-0.161 0.444,-0.171 0.635,-0.029 0.039,0.029 3.922,2.9 8.7,2.9 4.766,0 8.662,-2.871 8.7,-2.9 0.191,-0.142 0.457,-0.13 0.635,0.029 0.177,0.16 0.217,0.424 0.094,0.628 C 18.635,0.843 15.547,5.871 9.335,5.871 3.123,5.871 0.034,0.843 -0.094,0.628 -0.217,0.423 -0.178,0.16 0,0"/></g></g></g></g></svg>',neutral:'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 47.5 47.5" style="enable-background:new 0 0 47.5 47.5;" xml:space="preserve" version="1.1" id="svg2"><metadata id="metadata8"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/></cc:Work></rdf:RDF></metadata><defs id="defs6"><clipPath id="clipPath16" clipPathUnits="userSpaceOnUse"><path id="path18" d="M 0,38 38,38 38,0 0,0 0,38 Z"/></clipPath></defs><g transform="matrix(1.25,0,0,-1.25,0,47.5)" id="g10"><g id="g12"><g clip-path="url(#clipPath16)" id="g14"><g transform="translate(36,19)" id="g20"><path id="path22" style="fill:#ffcc4d;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 c 0,-9.389 -7.611,-17 -17,-17 -9.388,0 -17,7.611 -17,17 0,9.388 7.612,17 17,17 C -7.611,17 0,9.388 0,0"/></g><g transform="translate(15,20.5)" id="g24"><path id="path26" style="fill:#664500;fill-opacity:1;fill-rule:nonzero;stroke:none" d="M 0,0 C 0,-1.934 -1.119,-3.5 -2.5,-3.5 -3.881,-3.5 -5,-1.934 -5,0 -5,1.933 -3.881,3.5 -2.5,3.5 -1.119,3.5 0,1.933 0,0"/></g><g transform="translate(28,20.5)" id="g28"><path id="path30" style="fill:#664500;fill-opacity:1;fill-rule:nonzero;stroke:none" d="M 0,0 C 0,-1.934 -1.119,-3.5 -2.5,-3.5 -3.881,-3.5 -5,-1.934 -5,0 -5,1.933 -3.881,3.5 -2.5,3.5 -1.119,3.5 0,1.933 0,0"/></g><g transform="translate(26,11)" id="g32"><path id="path34" style="fill:#664500;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 -14,0 c -0.552,0 -1,0.447 -1,1 0,0.553 0.448,1 1,1 L 0,2 C 0.553,2 1,1.553 1,1 1,0.447 0.553,0 0,0"/></g></g></g></g></svg>'}}),Ext.define("TsSummaryRow",{extend:"Ext.data.Model",fields:[{name:"CycleTimeMedian",type:"int",defaultValue:NaN},{name:"CycleTimeCurrentPeriod",type:"int",defaultValue:NaN},{name:"CycleTimeTrend",type:"string",defaultValue:"Loading"},{name:"ThroughputMedian",type:"float",defaultValue:NaN},{name:"ThroughputTrend",type:"string",defaultValue:"Loading"},{name:"FeatureWipAverage",type:"float",defaultValue:NaN}]}),Ext.define("TsFeatureGroup",{extend:"Ext.data.Model",fields:[{name:"PortfolioItem"},{name:"Features"},{name:"LeafProjectsHash"}]}),Ext.override(Rally.data.wsapi.TreeStore,{_decorateModels:function(){var a=this.model;_.isFunction(a.getArtifactComponentModels)&&(a=a.getArtifactComponentModels()),Ext.Array.each(a,function(a){var b=TsSummaryRow.getFields();_.forEach(b,function(b){!a.getField(b.name)})}),_.each(Ext.Array.from(a),Rally.ui.grid.data.NodeInterface.decorate,Rally.ui.grid.data.NodeInterface)}}),Ext.define("TsConstants",{statics:{PORTFOLIO_ITEM_TYPE:"PortfolioItem/Feature",PORTFOLIO_ITEM_STORE_ID:"PORTFOLIO_ITEM_STORE_ID",GRID_STORE_ID:"GRID_STORE_ID",PER_PROJECT_WIP_LIMIT:3,PERIOD_LENGTH_SETTING:"PERIOD_LENGTH_SETTING",PERIOD_LENGTH_DEFAULT:30,MGMT_PROJECT_NAMES_SETTING:"MGMT_PROJECT_NAMES_SETTING",SELECTABLE_PORTFOLIO_ITEM_TYPE:"PortfolioItem/Group",SELECTABLE_PORTFOLIO_ITEM_TYPE_LABEL:"Affiliate",ROW_PORTFOLIO_ITEM_TYPE:"PortfolioItem/Epic",ROW_METRICS_PORTFOLIO_ITEM_TYPE:"PortfolioItem/Feature",WIP_LABEL:"Active Features Per-Dev Team (Average)",INCLUDED_PROJECT_TEAM_TYPES_SETTING:"INCLUDED_PROJECT_TEAM_TYPES_SETTING",PER_TEAM_WIP_MAX_SETTING:"PER_TEAM_WIP_MAX_SETTING"}}),Ext.define("TsMetricsUtils",function(a){function b(a){var b=!0;return a.get("_type").startsWith("portfolioitem/theme")?b=!1:a.get("_type").startsWith("portfolioitem")||(b=!1),b}function c(a){String.prototype.startsWith=function(a,b){return this.substr(!b||0>b?0:+b,a.length)===a}}function d(a){var b=_.unique(_.sortBy(a)),c=b.length,d=void 0;return c>0&&(d=c%2==0?(b[c/2-1]+b[c/2])/2:b[Math.floor(c/2)]),Math.ceil(d)}function e(a,b){var c=Ext.Date.parse(a,"c",!0),d=Ext.Date.parse(b,"c",!0),e=void 0,f=Ext.Date.getDayOfYear(c),g=Ext.Date.getDayOfYear(d);if(g>=f)e=g-f;else{var h=Ext.Date.isLeapYear(c)?365:364;e=g+h-f}return e}return{statics:{getMedian:d,getDaysElapsed:e,startsWith:c,showMetrics:b}}}),Ext.define("TsMetricsMgr",function(a){function b(a){_.forEach(a,function(a){TsMetricsUtils.showMetrics(a)&&f(a).then(function(b){var c=a.get("ObjectID");return g([c],[TsConstants.ROW_METRICS_PORTFOLIO_ITEM_TYPE]).then(function(c){return Ext.create("TsFeatureGroup",{PortfolioItem:a,Features:c,LeafProjectsHash:b||{}})})}).then(function(a){return d([a])}).then(function(b){return b.length>1&&console.error("Unexpected number of summary rows for a portfolio item"),c(a,b[0])})})}function c(a,b){var c=TsSummaryRow.getFields();return _.forEach(c,function(c){a.set(c.name,b.get(c.name))}),a}function d(a){var b=_.map(a,function(a){var b=(a.get("PortfolioItem"),e(a)),c=TsMetricsUtils.getMedian(b.allCycleTimes),d=TsMetricsUtils.getMedian(b.priorPeriodCycleTimes),f=TsMetricsUtils.getMedian(b.currentPeriodCycleTimes),g=(f-d).toFixed(0),h=0,i=a.get("LeafProjectsHash");return i&&(h=b.workInProgress/Object.keys(i).length),Ext.create("TsSummaryRow",{CycleTimeMedian:c,CycleTimeCurrentPeriod:f,CycleTimeTrend:g,ThroughputMedian:b.currentPeriodThroughput,ThroughputTrend:b.currentPeriodThroughput-b.priorPeriodThroughput,FeatureWipAverage:h})});return b}function e(a){var b=Rally.getApp().getSetting(TsConstants.PERIOD_LENGTH_SETTING)||TsConstants.PERIOD_LENGTH_DEFAULT,c=new Date,d=Ext.Date.subtract(c,Ext.Date.DAY,2*b),e=Ext.Date.subtract(c,Ext.Date.DAY,b),f=Ext.Date.subtract(e,Ext.Date.DAY,1),g=Ext.Date.subtract(c,Ext.Date.DAY,1),h=_.reduce(a.get("Features"),function(a,b){var c=b.raw.ActualStartDate?Ext.Date.parse(b.raw.ActualStartDate,"c"):null,h=b.raw.ActualEndDate?Ext.Date.parse(b.raw.ActualEndDate,"c"):null;if(c&&h){var i=TsMetricsUtils.getDaysElapsed(c,h);a.allCycleTimes.push(i),Ext.Date.between(h,d,f)?(a.priorPeriodCycleTimes.push(i),a.priorPeriodThroughput++):Ext.Date.between(h,e,g)&&(a.currentPeriodCycleTimes.push(i),a.currentPeriodThroughput++)}return c&&!h&&a.workInProgress++,a},{allCycleTimes:[],priorPeriodCycleTimes:[],currentPeriodCycleTimes:[],priorPeriodThroughput:0,currentPeriodThroughput:0,workInProgress:0,projects:[]});return h}function f(a){var b={},c=a.get("Project").ObjectID,d=Ext.create("Deft.Deferred");if(a.get("Project").Children&&0!=a.get("Project").Children.Count){var e=["Agile"],f=Rally.data.wsapi.Filter.or(_.map(e,function(a){return{property:"c_TeamType",value:a}})),g=Rally.data.wsapi.Filter.or(_.map(_.range(1,10),function(a){var b=[];do b.push("Parent");while(b.length<a);return{property:b.join(".")+".ObjectID",value:c}})).and({property:"Children.ObjectID",value:null});Ext.create("Rally.data.wsapi.Store",{model:"Project",autoLoad:!0,filters:f.and(g),fetch:["Children","Name","c_TeamType"],listeners:{scope:this,load:function(a,e,f){f?(_.forEach(e,function(a){b[a.get("ObjectID")]=a.get("Name")}),d.resolve(b)):d.reject("Unable to load child projects for Object ID "+c)}}})}else b[a.get("Project").ObjectID]=a.get("Project").Name,d.resolve(b);return d.getPromise()}function g(a,b,c){var d=Ext.create("Deft.Deferred"),e=c;return e||(e=[]),e.push({property:"_TypeHierarchy",operator:"in",value:b}),e.push({property:"__At",value:"current"}),e.push({property:"_ItemHierarchy",operator:"in",value:a}),Ext.create("Rally.data.lookback.SnapshotStore",{autoLoad:!0,limit:1/0,filters:e,fetch:["FormattedID","Name","ActualStartDate","ActualEndDate","Project","PortfolioItemType","PortfolioItemTypeName"],listeners:{load:function(b,c,e){e?d.resolve(c):d.reject("Unable to load descendents for Object IDs "+a)}}}),d.getPromise()}return{buildMetrics:b}}),Ext.define("com.ca.TechnicalServices.PortfolioItemHealthSummary",{extend:"Rally.app.App",componentCls:"app",logger:new CArABU.technicalservices.Logger,items:[{xtype:"form",itemId:"controlsArea"},{xtype:"container",itemId:"gridArea"}],integrationHeaders:{name:"com.ca.TechnicalServices.PortfolioItemHealthSummary"},launch:function(){this.logger.setSaveForLater(this.getSetting("saveLog")),this.metricsMgr=new TsMetricsMgr,this.down("#controlsArea").add({xtype:"rallysearchcombobox",storeConfig:{model:TsConstants.SELECTABLE_PORTFOLIO_ITEM_TYPE,autoLoad:!0},fieldLabel:TsConstants.SELECTABLE_PORTFOLIO_ITEM_TYPE_LABEL,listeners:{scope:this,change:function(a,b){this.addGrid(a.getRecord())}}})},addGrid:function(a){var b=Rally.getApp().getSetting(TsConstants.PERIOD_LENGTH_SETTING)||TsConstants.PERIOD_LENGTH_DEFAULT;Ext.create("Rally.data.wsapi.TreeStoreBuilder").build({models:["PortfolioItem/Theme"],autoLoad:!0,enableHierarchy:!0,filters:[{property:"Parent.ObjectID",value:a.get("ObjectID")}],listeners:{scope:this,load:function(a,b,c){this.metricsMgr.buildMetrics(c)}}}).then({scope:this,success:function(a){var c=this.down("#gridArea");c.removeAll(),c.add({xtype:"rallytreegrid",store:a,columnCfgs:[{text:"Name",dataIndex:"Name"},{text:"% Complete by Story Points",dataIndex:"PercentDoneByStoryPlanEstimate"},{text:"% Complete by Story Count",dataIndex:"PercentDoneByStoryCount"},{text:"Cycle Time - Overall Median (Days)",xtype:"templatecolumn",tpl:new Ext.XTemplate(""),scope:this,renderer:function(a,b,c){return this.nanRenderer(c,"CycleTimeMedian")}},{text:"Cycle Time - Last "+b+" Days",xtype:"templatecolumn",tpl:new Ext.XTemplate(""),scope:this,renderer:function(a,b,c){return this.nanRenderer(c,"CycleTimeCurrentPeriod")}},{text:"Cycle Time - "+b+" Day Trend",tpl:"{CycleTimeTrend}",xtype:"templatecolumn",scope:this,renderer:function(a,b,c){return this.cycleTimeTrendRenderer(c,"CycleTimeTrend")}},{text:"Throughput - Last "+b+" Days",xtype:"templatecolumn",tpl:new Ext.XTemplate(""),scope:this,renderer:function(a,b,c){return this.nanRenderer(c,"ThroughputMedian")}},{text:"Throughput - "+b+" Day Trend",tpl:"{ThroughputTrend}",xtype:"templatecolumn",scope:this,renderer:function(a,b,c){return this.throughputTrendRenderer(c,"ThroughputTrend")}},{text:TsConstants.WIP_LABEL,xtype:"templatecolumn",tpl:new Ext.XTemplate(""),scope:this,renderer:function(a,b,c){return this.wipRenderer(c)}}]})}})},wipRenderer:function(a){var b=a.get("FeatureWipAverage"),c=b;return 0==TsMetricsUtils.showMetrics(a)?c="--":void 0===b?c="Loading...":isNaN(b)?c="--":b==1/0?c=0:b>0&&1>b?c=1:(c=Math.round(b),c>=4&&(c='<div class="colorcell caution">'+c+"</div>")),c},nanRenderer:function(a,b){var c=a.get(b),d=c;return 0==TsMetricsUtils.showMetrics(a)?d="--":void 0===c?d="Loading...":isNaN(c)&&(d="--"),d},cycleTimeTrendRenderer:function(a,b){var c=a.get(b),d=c;return d=0==TsMetricsUtils.showMetrics(a)?"--":void 0===c?"Loading...":c>0?this.getEmojiDiv("worse")+c+" days slower":0>c?this.getEmojiDiv("better")+Math.abs(c)+" days faster":0==c?this.getEmojiDiv("neutral")+"Unchanged":"--"},getEmojiDiv:function(a){return'<div class="emojicell '+a+'">'+TsSvgIcons[a]+"</div>"},throughputTrendRenderer:function(a,b){var c=a.get(b),d=c;return d=0==TsMetricsUtils.showMetrics(a)?"--":void 0===c?"Loading...":c>0?this.getEmojiDiv("better")+c+" more Features":0>c?this.getEmojiDiv("worse")+Math.abs(c)+" less Features":0==c?this.getEmojiDiv("neutral")+"Unchanged":"--"},getSettingsFields:function(){var a="5 0 5 0";return[{name:"saveLog",xtype:"rallycheckboxfield",boxLabelAlign:"after",fieldLabel:"",margin:a,boxLabel:'Save Logging<br/><span style="color:#999999;"><i>Save last 100 lines of log for debugging.</i></span>'},{name:TsConstants.PERIOD_LENGTH_SETTING,xtype:"numberfield",fieldLabel:"Trend Time Period (Days)"},{name:TsConstants.INCLUDED_PROJECT_TEAM_TYPES_SETTING,xtype:"textfield",disabled:!0,value:"Agile",fieldLabel:'Project Team Types to include in "'+TsConstants.WIP_LABEL+'" calculation'},{name:TsConstants.PER_TEAM_WIP_MAX_SETTING,xtype:"textfield",disabled:!0,value:"4",fieldLabel:'Max "'+TsConstants.WIP_LABEL+'"'}]},getOptions:function(){var a=[{text:"About...",handler:this._launchInfo,scope:this}];return a},_launchInfo:function(){this.about_dialog&&this.about_dialog.destroy(),this.about_dialog=Ext.create("Rally.technicalservices.InfoLink",{showLog:this.getSetting("saveLog"),logger:this.logger})}});

               Rally.launchApp('com.ca.TechnicalServices.PortfolioItemHealthSummary', {
                   name: 'Portfolio Item Health Summary'
               });
        });
    </script>

    <style type="text/css">

.app {}

.tsinfolink {
    position: absolute;
    right: 0px;
    width: 14px;
    height: 14px;
    border-radius: 7px;
    text-align: center;
    color: white;
    background: #C0C0C0;
    border-style: solid;
    border-width: 1px;
    margin-top: 25px;
    margin-right: 5px;
    cursor: pointer;
}

.colorcell {
    border-radius: 3px;
}

.colorcell.better {
    background-color: rgb(130, 190, 55);
}

.colorcell.worse {
    background-color: rgb(245, 88, 64);
}

.colorcell.caution {
    background-color: rgb(249, 203, 7);
}

.emojicell svg {
    height: 15px;
}

    </style>

</head>
<body></body>
</html>